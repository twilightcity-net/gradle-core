buildscript {
	repositories {
		jcenter()
	}
}

apply plugin: "org.dreamscale.core-oss"
apply plugin: "org.dreamscale.integration-test"

repositories {
	mavenLocal()
	jcenter()
    maven {
        url "https://plugins.gradle.org/m2/"
    }
}

dependencies {
	compile gradleApi()
	compile "net.jokubasdargis.buildtimer:gradle-plugin:0.3.0"
	compile "gradle.plugin.nl.javadude.gradle.plugins:license-gradle-plugin:0.14.0"
	compile 'org.eclipse.jgit:org.eclipse.jgit:4.10.0.201712302008-r'
	compile "org.betterdevxp:gradle-docker-dsl-plugin:0.+"

	mainTestCompile gradleTestKit()
	mainTestCompile 'commons-io:commons-io:2.4'
	mainTestCompile 'com.google.guava:guava:30.1.1-jre'
	mainTestCompile('org.spockframework:spock-core:1.1-groovy-2.4') {
		exclude group: 'org.codehaus.groovy'
	}
	mainTestCompile 'cglib:cglib-nodep:2.2.2'
	mainTestCompile 'org.objenesis:objenesis:1.3'
}

check.dependsOn integrationTest

license {
	ext.name = "TwilightCity, Inc"
	skipExistingHeaders true
}

[licenseMain, licenseFormatMain]*.exclude "licenses/*"
[licenseMain, licenseFormatMain]*.exclude "**/*.sh"
// exclude the test kit source which was copied from a different project (https://github.com/alkemist/gradle-test-kit)
// and has it's own license
[licenseMainTest, licenseFormatMainTest]*.exclude "org/gradle/testkit/**"


publishing_ext {
	publication("mainTest")
	publishJavadoc true
}

jar {
    manifest {
        attributes("Implementation-Version": project.version)
    }
}

ext["organization.repo.url"] = "https://github.com/twilightcity-net"
